/*! js-cookie v3.0.5 | MIT */
function e(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)e[n]=o[n]}return e}var t=function t(o,n){function i(t,i,r){if("undefined"!=typeof document){"number"==typeof(r=e({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var c in r)r[c]&&(s+="; "+c,!0!==r[c]&&(s+="="+r[c].split(";")[0]));return document.cookie=t+"="+o.write(i,t)+s}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},i=0;i<t.length;i++){var r=t[i].split("="),s=r.slice(1).join("=");try{var c=decodeURIComponent(r[0]);if(n[c]=o.read(s,c),e===c)break}catch(e){}}return e?n[e]:n}},remove:function(t,o){i(t,"",e({},o,{expires:-1}))},withAttributes:function(o){return t(this.converter,e({},this.attributes,o))},withConverter:function(o){return t(e({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(o)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});document.addEventListener("alpine:init",(()=>{Alpine.data("PromoPopup",(e=>{let{delay:o,frequency:n,enabled:i,hasErrors:r,hasSuccessMessage:s}=e;return{delay:o,frequency:n,enabled:i,sectionId:null,cookieName:null,async init(){if(this.sectionId=this.$root.id,this.cookieName=`switch-popup-${this.sectionId}`,"/challenge"===window.location.pathname)return;initTeleport(this.$root),Alpine.store("modals").register("promoPopup","promo"),document.body.addEventListener("promo-is-closed",(e=>{t.set(this.cookieName,"shown",{path:"/",expires:this.frequency})}));const e=this.$refs.teleported.content.querySelector("template").content,o=Boolean(e.querySelector("[data-errors]"));(Boolean(e.querySelector("[data-success-message]"))||o)&&(this.open(),this.clearSuccessParams(),t.set(this.cookieName,"shown",{path:"/",expires:200})),Shopify.designMode?(window.theme.designMode.selected===this.sectionId&&(!0===this.enabled?this.open():Alpine.store("modals").close("promoPopup")),document.addEventListener("shopify:section:select",(e=>{e.target.contains(this.$root)&&this.enabled&&this.open()})),document.addEventListener("shopify:section:deselect",(e=>{e.target.contains(this.$root)&&this.$store.modals.close("promoPopup")}))):"shown"!==t.get(this.cookieName)&&setTimeout((()=>{this.open();const e=t=>{"Escape"===t.code&&(this.$store.modals.close("promoPopup"),document.body.removeEventListener("keydown",e))};document.body.addEventListener("keydown",e)}),1e3*this.delay)},open(){this.$store.modals.open("promoPopup"),this.$focus.first()},clearSuccessParams(){console.log(window.location),console.log(window.location.search);const e=new URLSearchParams(window.location.search);let t;e.has("customer_posted")&&e.delete("customer_posted"),t=e.toString().length>0?`${window.location.pathname}?${e.toString()}`:window.location.pathname,console.log(window.location.pathname+e.toString()),history.replaceState("",document.title,t)}}}))}));
